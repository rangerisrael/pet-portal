import { NextResponse } from 'next/server'; import { supabase } from '@/lib/supabase'; export async function GET() { try { console.log('Testing Supabase Storage...'); if (\!supabase) { return NextResponse.json({ error: 'Supabase client not initialized', details: 'Check environment variables' }, { status: 500 }); } const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets(); if (bucketsError) { return NextResponse.json({ error: 'Failed to list storage buckets', details: bucketsError.message }, { status: 500 }); } const petPortalBucket = buckets.find(bucket => bucket.name === 'pet-portal'); return NextResponse.json({ success: true, buckets: buckets.map(bucket => ({ name: bucket.name, public: bucket.public })), petPortalBucketExists: \!\!petPortalBucket, message: petPortalBucket ? 'Storage configured correctly' : 'Need to create pet-portal bucket' }); } catch (error) { return NextResponse.json({ error: 'Storage test failed', details: error.message }, { status: 500 }); } }
